<Window x:Class="TheEyeOfCthulhu.Lab.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:eye="clr-namespace:TheEyeOfCthulhu.WPF.Controls;assembly=TheEyeOfCthulhu.WPF"
        Title="ðŸ‘ï¸ The Eye of Cthulhu - Lab" 
        Height="720" Width="1100"
        WindowStartupLocation="CenterScreen"
        Background="#1E1E1E">
    
    <Grid>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="*" />
            <ColumnDefinition Width="280" />
        </Grid.ColumnDefinitions>
        
        <!-- Zone vidÃ©o principale -->
        <Border Grid.Column="0" 
                Margin="10" 
                BorderBrush="#3F3F3F" 
                BorderThickness="1"
                CornerRadius="4">
            <eye:VisionView x:Name="VisionView" 
                            ShowInfo="True"
                            ImageClicked="VisionView_ImageClicked"
                            RoiSelected="VisionView_RoiSelected" />
        </Border>
        
        <!-- Panneau de contrÃ´le -->
        <Border Grid.Column="1" 
                Margin="0,10,10,10" 
                Background="#2D2D2D" 
                BorderBrush="#3F3F3F" 
                BorderThickness="1"
                CornerRadius="4">
            <ScrollViewer VerticalScrollBarVisibility="Auto">
                <StackPanel Margin="15">
                    
                    <!-- Source Selection -->
                    <TextBlock Text="VIDEO SOURCE" 
                               Foreground="#888" 
                               FontWeight="Bold" 
                               Margin="0,0,0,10" />
                    
                    <ComboBox x:Name="SourceComboBox" 
                              SelectionChanged="SourceComboBox_SelectionChanged"
                              Margin="0,0,0,10">
                        <ComboBoxItem Content="DroidCam" IsSelected="True" />
                        <ComboBoxItem Content="Webcam" />
                    </ComboBox>
                    
                    <!-- DroidCam Settings -->
                    <StackPanel x:Name="DroidCamPanel">
                        <TextBlock Text="IP Address" Foreground="#CCC" Margin="0,0,0,4" />
                        <TextBox x:Name="IpTextBox" Text="192.168.1.57" Margin="0,0,0,10" />
                        
                        <TextBlock Text="Port" Foreground="#CCC" Margin="0,0,0,4" />
                        <TextBox x:Name="PortTextBox" Text="4747" Margin="0,0,0,10" />
                    </StackPanel>
                    
                    <!-- Webcam Settings -->
                    <StackPanel x:Name="WebcamPanel" Visibility="Collapsed">
                        <TextBlock Text="Device Index" Foreground="#CCC" Margin="0,0,0,4" />
                        <TextBox x:Name="WebcamIndexTextBox" Text="0" Margin="0,0,0,10" />
                    </StackPanel>
                    
                    <!-- Controls -->
                    <Grid Margin="0,10,0,10">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*" />
                            <ColumnDefinition Width="*" />
                        </Grid.ColumnDefinitions>
                        
                        <Button x:Name="StartButton" 
                                Content="â–¶ Start" 
                                Grid.Column="0" 
                                Margin="0,0,5,0"
                                Padding="10,8"
                                Click="StartButton_Click"
                                Background="#0E7A0D"
                                Foreground="White" />
                        
                        <Button x:Name="StopButton" 
                                Content="â¬› Stop" 
                                Grid.Column="1" 
                                Margin="5,0,0,0"
                                Padding="10,8"
                                Click="StopButton_Click"
                                IsEnabled="False"
                                Background="#C42B1C"
                                Foreground="White" />
                    </Grid>
                    
                    <Button x:Name="SnapshotButton" 
                            Content="ðŸ“¸ Snapshot" 
                            Margin="0,0,0,10"
                            Padding="10,8"
                            Click="SnapshotButton_Click"
                            IsEnabled="False" />
                    
                    <Separator Margin="0,10" Background="#3F3F3F" />
                    
                    <!-- ðŸ”¯ ELDER SIGN -->
                    <TextBlock Text="ðŸ”¯ ELDER SIGN" 
                               Foreground="#C586C0" 
                               FontWeight="Bold" 
                               Margin="0,0,0,10" />
                    
                    <CheckBox x:Name="RoiModeCheckBox" 
                              Content="âœ‚ï¸ Select ROI (draw rectangle)" 
                              Foreground="#00CED1"
                              Margin="0,0,0,10"
                              Checked="RoiModeCheckBox_Changed"
                              Unchecked="RoiModeCheckBox_Changed"
                              IsEnabled="False" />
                    
                    <Button x:Name="CaptureElderSignButton" 
                            Content="ðŸ“· Capture ElderSign" 
                            Margin="0,0,0,5"
                            Padding="10,8"
                            Click="CaptureElderSignButton_Click"
                            IsEnabled="False"
                            Background="#6A0DAD"
                            Foreground="White" />
                    
                    <TextBlock x:Name="RoiInfoText" 
                               Text="ðŸ’¡ Enable ROI mode to select a region" 
                               Foreground="#666"
                               FontSize="10"
                               Margin="0,0,0,10" />
                    
                    <Button x:Name="ClearElderSignButton" 
                            Content="ðŸ—‘ï¸ Clear ElderSign" 
                            Margin="0,0,0,10"
                            Padding="10,8"
                            Click="ClearElderSignButton_Click"
                            IsEnabled="False" />
                    
                    <CheckBox x:Name="EnableElderSignCheckBox" 
                              Content="Enable Detection" 
                              Foreground="#C586C0"
                              Margin="0,0,0,5"
                              IsEnabled="False"
                              Checked="EnableElderSignCheckBox_Changed"
                              Unchecked="EnableElderSignCheckBox_Changed" />
                    
                    <!-- Matcher Type -->
                    <StackPanel Margin="10,5,0,0">
                        <TextBlock Text="Matcher:" Foreground="#999" FontSize="11" />
                        <ComboBox x:Name="MatcherTypeComboBox" 
                                  Margin="0,3,0,0"
                                  SelectionChanged="MatcherTypeComboBox_SelectionChanged">
                            <ComboBoxItem Content="Template (fast, no rotation)" IsSelected="True" />
                            <ComboBoxItem Content="ORB Features (rotation+scale)" />
                            <ComboBoxItem Content="AKAZE Features (robust)" />
                        </ComboBox>
                    </StackPanel>
                    
                    <StackPanel Margin="10,5,0,0">
                        <TextBlock Text="Min Score:" Foreground="#999" FontSize="11" />
                        <Slider x:Name="MinScoreSlider" 
                                Minimum="0.5" Maximum="0.99" Value="0.7" 
                                TickFrequency="0.05" IsSnapToTickEnabled="True"
                                ValueChanged="MinScoreSlider_ValueChanged" />
                        <TextBlock x:Name="MinScoreText" Text="70%" Foreground="#999" FontSize="11" HorizontalAlignment="Right" Margin="0,-5,0,0" />
                    </StackPanel>
                    
                    <Border x:Name="ElderSignPreview" 
                            Background="#1A1A1A" 
                            BorderBrush="#3F3F3F" 
                            BorderThickness="1"
                            CornerRadius="4"
                            Height="80"
                            Margin="0,10,0,0"
                            Visibility="Collapsed">
                        <Grid>
                            <Image x:Name="ElderSignImage" Stretch="Uniform" Margin="5" />
                            <TextBlock x:Name="ElderSignSizeText" 
                                       Text="" 
                                       Foreground="#888" 
                                       FontSize="10"
                                       VerticalAlignment="Bottom"
                                       HorizontalAlignment="Right"
                                       Margin="5" />
                        </Grid>
                    </Border>
                    
                    <TextBlock x:Name="ElderSignResultText" 
                               Text="" 
                               Foreground="#C586C0"
                               TextWrapping="Wrap"
                               FontSize="11"
                               Margin="0,10,0,0" />
                    
                    <Separator Margin="0,15" Background="#3F3F3F" />
                    
                    <!-- Processing Pipeline -->
                    <TextBlock Text="PROCESSING PIPELINE" 
                               Foreground="#888" 
                               FontWeight="Bold" 
                               Margin="0,0,0,10" />
                    
                    <CheckBox x:Name="EnablePipelineCheckBox" 
                              Content="Enable Processing" 
                              Foreground="#CCC"
                              Margin="0,0,0,10"
                              Checked="EnablePipelineCheckBox_Changed"
                              Unchecked="EnablePipelineCheckBox_Changed" />
                    
                    <StackPanel x:Name="ProcessorsPanel" Margin="10,0,0,0">
                        <CheckBox x:Name="GrayscaleCheckBox" Content="Grayscale" Foreground="#CCC" IsChecked="True" Margin="0,4" Click="ProcessorCheckBox_Click" />
                        <CheckBox x:Name="BlurCheckBox" Content="Gaussian Blur" Foreground="#CCC" IsChecked="True" Margin="0,4" Click="ProcessorCheckBox_Click" />
                        <CheckBox x:Name="ThresholdCheckBox" Content="Threshold (Otsu)" Foreground="#CCC" IsChecked="True" Margin="0,4" Click="ProcessorCheckBox_Click" />
                        <CheckBox x:Name="CannyCheckBox" Content="Canny Edge" Foreground="#CCC" IsChecked="True" Margin="0,4" Click="ProcessorCheckBox_Click" />
                        <CheckBox x:Name="ContoursCheckBox" Content="Contour Detection" Foreground="#CCC" IsChecked="True" Margin="0,4" Click="ProcessorCheckBox_Click" />
                        <CheckBox x:Name="HoughCirclesCheckBox" Content="ðŸ”µ Hough Circles" Foreground="#4FC3F7" IsChecked="False" Margin="0,4" Click="ProcessorCheckBox_Click" />
                    </StackPanel>
                    
                    <!-- Hough Circles Settings -->
                    <StackPanel x:Name="HoughCirclesSettings" Margin="10,10,0,0" Visibility="Collapsed">
                        <TextBlock Text="Min Radius:" Foreground="#4FC3F7" FontSize="10" />
                        <Grid>
                            <Slider x:Name="HoughMinRadiusSlider" Minimum="0" Maximum="200" Value="20" 
                                    TickFrequency="10" IsSnapToTickEnabled="True" 
                                    PreviewMouseUp="HoughSlider_MouseUp" 
                                    LostMouseCapture="HoughSlider_LostCapture" />
                            <TextBlock x:Name="HoughMinRadiusText" Text="20" Foreground="#888" FontSize="9" 
                                       HorizontalAlignment="Right" VerticalAlignment="Center" Margin="0,0,5,0" />
                        </Grid>
                        
                        <TextBlock Text="Max Radius:" Foreground="#4FC3F7" FontSize="10" Margin="0,5,0,0" />
                        <Grid>
                            <Slider x:Name="HoughMaxRadiusSlider" Minimum="0" Maximum="500" Value="200" 
                                    TickFrequency="10" IsSnapToTickEnabled="True" 
                                    PreviewMouseUp="HoughSlider_MouseUp" 
                                    LostMouseCapture="HoughSlider_LostCapture" />
                            <TextBlock x:Name="HoughMaxRadiusText" Text="200" Foreground="#888" FontSize="9" 
                                       HorizontalAlignment="Right" VerticalAlignment="Center" Margin="0,0,5,0" />
                        </Grid>
                        
                        <TextBlock Text="Sensitivity (lower=more):" Foreground="#4FC3F7" FontSize="10" Margin="0,5,0,0" />
                        <Grid>
                            <Slider x:Name="HoughSensitivitySlider" Minimum="10" Maximum="150" Value="50" 
                                    TickFrequency="5" IsSnapToTickEnabled="True" 
                                    PreviewMouseUp="HoughSlider_MouseUp" 
                                    LostMouseCapture="HoughSlider_LostCapture" />
                            <TextBlock x:Name="HoughSensitivityText" Text="50" Foreground="#888" FontSize="9" 
                                       HorizontalAlignment="Right" VerticalAlignment="Center" Margin="0,0,5,0" />
                        </Grid>
                        
                        <TextBlock x:Name="HoughResultText" Text="" Foreground="#4FC3F7" FontSize="11" 
                                   Margin="0,8,0,0" TextWrapping="Wrap" FontWeight="SemiBold" />
                    </StackPanel>
                    
                    <Separator Margin="0,15" Background="#3F3F3F" />
                    
                    <!-- Info -->
                    <TextBlock Text="INFO" 
                               Foreground="#888" 
                               FontWeight="Bold" 
                               Margin="0,0,0,10" />
                    
                    <TextBlock x:Name="ClickInfoText" 
                               Text="Click on image to get coordinates" 
                               Foreground="#666"
                               TextWrapping="Wrap"
                               FontSize="11" />
                    
                    <TextBlock x:Name="ProcessingInfoText" 
                               Text="" 
                               Foreground="#0A0"
                               TextWrapping="Wrap"
                               FontSize="11"
                               Margin="0,10,0,0" />
                    
                </StackPanel>
            </ScrollViewer>
        </Border>
    </Grid>
</Window>
